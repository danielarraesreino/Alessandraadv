{% extends "admin_portal/base.html" %}

{% block title %}Leads - Kanban{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Gest√£o de Leads</h1>
    <p class="page-subtitle">Organize e converta seus leads</p>
</div>

<div class="kanban-board">
    <!-- Novos Leads -->
    <div class="kanban-column">
        <div class="kanban-header">
            üì• Novos ({{ new_leads.count }})
        </div>
        {% for lead in new_leads %}
        <div class="kanban-card" data-url="{% url 'admin_portal:lead_detail' lead.id %}"
            onclick="window.location.href=this.dataset.url;">
            <div class="lead-name">{{ lead.full_name }}</div>
            <div class="lead-type">{{ lead.get_case_type_display }}</div>
            <div class="lead-score" style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                <span style="font-weight: bold;">Score: {{ lead.score }}</span>
                {% if lead.viability_status == 'HIGH' %}
                <span
                    style="background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem;">Alta</span>
                {% elif lead.viability_status == 'MEDIUM' %}
                <span
                    style="background: #fef9c3; color: #854d0e; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem;">M√©dia</span>
                {% elif lead.viability_status == 'LOW' %}
                <span
                    style="background: #fee2e2; color: #991b1b; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem;">Baixa</span>
                {% elif lead.viability_status == 'REJECTED' %}
                <span
                    style="background: #f3f4f6; color: #374151; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem;">Invi√°vel</span>
                {% endif %}
            </div>
            <div style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--color-gray);">
                {{ lead.created_at|date:"d/m/Y H:i" }}
            </div>
        </div>
        {% empty %}
        <p style="color: var(--color-gray); font-size: 0.9rem; text-align: center; padding: 2rem 0;">
            Nenhum lead novo
        </p>
        {% endfor %}
    </div>

    <!-- Qualificados -->
    <div class="kanban-column">
        <div class="kanban-header">
            ‚≠ê Qualificados ({{ qualified_leads.count }})
        </div>
        {% for lead in qualified_leads %}
        <div class="kanban-card" data-url="{% url 'admin_portal:lead_detail' lead.id %}"
            onclick="window.location.href=this.dataset.url;">
            <div class="lead-name">{{ lead.full_name }}</div>
            <div class="lead-type">{{ lead.get_case_type_display }}</div>
            <div class="lead-score" style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                <span style="font-weight: bold;">Score: {{ lead.score }}</span>
                <span
                    style="background: #dcfce7; color: #166534; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem;">Qualificado</span>
            </div>
            <div style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--color-gray);">
                {{ lead.created_at|date:"d/m/Y H:i" }}
            </div>
        </div>
        {% empty %}
        <p style="color: var(--color-gray); font-size: 0.9rem; text-align: center; padding: 2rem 0;">
            Nenhum lead qualificado
        </p>
        {% endfor %}
    </div>

    <!-- Convertidos -->
    <div class="kanban-column">
        <div class="kanban-header">
            ‚úÖ Convertidos ({{ converted_leads.count }})
        </div>
        {% for lead in converted_leads %}
        <div class="kanban-card" data-url="{% url 'admin_portal:lead_detail' lead.id %}"
            onclick="window.location.href=this.dataset.url;">
            <div class="lead-name">{{ lead.full_name }}</div>
            <div class="lead-type">{{ lead.get_case_type_display }}</div>
            <div style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--color-gray);">
                Convertido em {{ lead.created_at|date:"d/m/Y" }}
            </div>
        </div>
        {% empty %}
        <p style="color: var(--color-gray); font-size: 0.9rem; text-align: center; padding: 2rem 0;">
            Nenhum lead convertido
        </p>
        {% endfor %}
    </div>
</div>
{% endblock %}
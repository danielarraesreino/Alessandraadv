{% extends "admin_portal/base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Dashboard</h1>
    <p class="page-subtitle">Visão geral do escritório</p>
</div>

<!-- Metrics Grid -->
<div class="metrics-grid">
    <div class="metric-card">
        <div class="metric-label">Leads Hoje</div>
        <div class="metric-value">{{ leads_today }}</div>
    </div>
    <div class="metric-card">
        <div class="metric-label">Leads (7 dias)</div>
        <div class="metric-value">{{ leads_week }}</div>
    </div>
    <div class="metric-card">
        <div class="metric-label">Leads (30 dias)</div>
        <div class="metric-value">{{ leads_month }}</div>
    </div>
    <div class="metric-card">
        <div class="metric-label">Leads Qualificados</div>
        <div class="metric-value">{{ leads_qualified }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ total_clients }}</div>
        <div class="stat-label">Total de Clientes</div>
    </div>
    <div class="stat-card" style="border-left: 4px solid #1a202c;">
        <div class="stat-value">R$ {{ total_contingency }}</div>
        <div class="stat-label">Valor em Contingência</div>
    </div>
    <div class="stat-card" style="border-left: 4px solid var(--color-salmon);">
        <div class="stat-value">R$ {{ finance_total_pending }}</div>
        <div class="stat-label">Contas a Pagar (Pendente)</div>
    </div>
    <div class="stat-card" style="border-left: 4px solid #48bb78;">
        <div class="stat-value">R$ {{ finance_receivable_pending }}</div>
        <div class="stat-label">Contas a Receber (Pendente)</div>
    </div>
    <div class="stat-card" style="border-left: 4px solid #e53e3e;">
        <div class="stat-value">{{ finance_late_count }}</div>
        <div class="stat-label">Contas em Atraso</div>
    </div>
    <div class="metric-card" style="border-left: 4px solid var(--color-black);">
        <div class="metric-label">Casos Ativos</div>
        <div class="metric-value">{{ active_cases }}</div>
    </div>
    <div class="metric-card" style="border-left: 4px solid var(--color-salmon);">
        <div class="metric-label">Artigos (Total)</div>
        <div class="metric-value">{{ total_articles }}</div>
    </div>
    <div class="metric-card" style="border-left: 4px solid #48bb78;">
        <div class="metric-label">Artigos Publicados</div>
        <div class="metric-value">{{ published_articles }}</div>
    </div>
    <div class="metric-card" style="border-left: 4px solid #ecc94b;">
        <div class="metric-label">Categorias</div>
        <div class="metric-value">{{ categories_count }}</div>
    </div>
</div>

<!-- Cases by Area -->
<div class="card">
    <h2 class="card-title">Casos por Área de Atuação</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        {% for area in cases_by_area %}
        <div style="padding: 1rem; background: var(--color-creme); border-radius: 8px; text-align: center;">
            <div style="font-size: 2rem; font-weight: 700; color: var(--color-salmon);">{{ area.count }}</div>
            <div style="font-size: 0.9rem; color: var(--color-gray); margin-top: 0.5rem;">{{
                area.get_area_display|default:area.area }}</div>
        </div>
        {% empty %}
        <p style="color: var(--color-gray);">Nenhum caso cadastrado ainda.</p>
        {% endfor %}
    </div>
</div>

<div
    style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg); margin-top: var(--space-lg); margin-bottom: var(--space-lg);">
    <!-- Lead Source Distribution -->
    <div class="card">
        <h2 class="card-title">Origem dos Leads</h2>
        <div style="display: grid; gap: 0.75rem;">
            {% for source in leads_by_source %}
            <div
                style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--color-creme); border-radius: 4px;">
                <span style="font-weight: 600;">{{ source.source|default:"Orgânico" }}</span>
                <span class="badge"
                    style="background: var(--color-salmon); color: black; padding: 2px 8px; border-radius: 10px;">{{
                    source.count }}</span>
            </div>
            {% empty %}
            <p style="color: var(--color-gray);">Sem dados de origem.</p>
            {% endfor %}
        </div>
    </div>

    <!-- Lead Location Distribution -->
    <div class="card">
        <h2 class="card-title">Distribuição Geográfica</h2>
        <div style="display: grid; gap: 0.75rem;">
            {% for loc in leads_by_location %}
            <div
                style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--color-creme); border-radius: 4px;">
                <span style="font-weight: 600;">{{ loc.location|default:"Brasil" }}</span>
                <span class="badge"
                    style="background: var(--color-black); color: white; padding: 2px 8px; border-radius: 10px;">{{
                    loc.count }}</span>
            </div>
            {% empty %}
            <p style="color: var(--color-gray);">Sem dados geográficos.</p>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <h2 class="card-title">Ações Rápidas</h2>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="{% url 'admin_portal:leads_kanban' %}" class="btn btn-primary">
            Ver Kanban de Leads
        </a>
        <a href="{% url 'admin_portal:clients_list' %}" class="btn btn-secondary">
            Gerenciar Clientes
        </a>
        <a href="{% url 'admin_portal:cases_kanban' %}" class="btn btn-secondary">
            Ver Painel de Casos
        </a>
        <a href="{% url 'admin_portal:article_list' %}" class="btn btn-secondary">
            Gerenciar Conteúdo (Blog)
        </a>
    </div>
</div>
{% endblock %}